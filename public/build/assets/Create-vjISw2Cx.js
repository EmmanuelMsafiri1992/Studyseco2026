import{p as P,r as A,s as h,c as r,o as d,a as w,u as o,h as T,w as V,b as t,q as $,j as b,n as p,d as c,v as x,F as y,f as k,t as i,g as S,i as U,l as L}from"./app--fhtQyYk.js";import{_ as Z}from"./DashboardLayout-DwXMIeFU.js";const B={class:"max-w-4xl mx-auto"},z={class:"bg-white/80 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-slate-200/50"},G={class:"flex space-x-4 mb-6"},I={key:0,class:"mb-6"},K={key:0,class:"mt-3 max-h-48 overflow-y-auto rounded-xl border border-slate-200"},Q=["onClick"],R={class:"font-medium text-slate-800"},W={class:"text-sm text-slate-500"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H=["readonly"],J={key:0,class:"text-red-500 text-xs mt-1"},X=["readonly"],ee={key:0,class:"text-red-500 text-xs mt-1"},te={key:0,class:"text-red-500 text-xs mt-1"},se={class:"md:col-span-2"},oe={key:0,class:"text-red-500 text-xs mt-1"},le={class:"bg-white/80 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-slate-200/50"},ne={class:"text-lg font-semibold text-slate-800 mb-4"},ie={class:"text-sm font-normal text-slate-500"},re={key:0,class:"text-red-500 text-sm mb-4"},de={class:"space-y-6"},ae={class:"flex items-center justify-between mb-3"},ue={class:"text-md font-medium text-slate-700"},me=["onClick"],ce={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},be=["onClick"],pe={class:"font-medium text-sm"},xe={key:0,class:"text-xs text-slate-500 mt-1"},fe={class:"bg-white/80 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-slate-200/50"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"md:col-span-2"},ye={class:"mt-6 p-4 bg-slate-50 rounded-2xl"},_e={class:"space-y-2 text-sm"},he={class:"flex justify-between"},we={class:"font-medium"},ke={class:"flex justify-between"},Se={class:"font-medium"},je={class:"flex justify-between pt-2 border-t border-slate-200"},Ce={class:"font-bold text-lg text-indigo-600"},Ee={class:"flex items-center justify-between"},Me=["disabled"],qe={__name:"Create",props:{subjects:Array,students:Array,paymentMethods:Array},setup(q){const _=q,s=P({user_id:null,name:"",email:"",phone:"",address:"",country:"Malawi",selected_subjects:[],enrollment_type:"paid",access_duration_months:4,admin_notes:""}),m=A(!0),f=A(""),j=h(()=>{const n={};return _.subjects.forEach(e=>{const l=e.grade_level||"Other";n[l]||(n[l]=[]),n[l].push(e)}),n}),C=h(()=>{if(!f.value)return _.students;const n=f.value.toLowerCase();return _.students.filter(e=>e.name.toLowerCase().includes(n)||e.email.toLowerCase().includes(n))}),D=n=>{s.user_id=n.id,s.name=n.name,s.email=n.email,s.phone=n.phone||"",m.value=!1},E=n=>{m.value=n,n&&(s.user_id=null,s.name="",s.email="",s.phone="")},N=n=>{const e=s.selected_subjects.indexOf(n);e>-1?s.selected_subjects.splice(e,1):s.selected_subjects.push(n)},g=n=>s.selected_subjects.includes(n),F=n=>{const e=j.value[n];e.every(u=>g(u.id))?e.forEach(u=>{const a=s.selected_subjects.indexOf(u.id);a>-1&&s.selected_subjects.splice(a,1)}):e.forEach(u=>{g(u.id)||s.selected_subjects.push(u.id)})},v=h(()=>{const n=s.country.toLowerCase();let e=5e4,l="MWK";return n==="south africa"||n==="za"?(e=350,l="ZAR"):["malawi","mw"].includes(n)||(e=25,l="USD"),(s.enrollment_type==="trial"||s.enrollment_type==="free")&&(e=0),{pricePerSubject:e,currency:l,total:e*s.selected_subjects.length}}),M=(n,e)=>new Intl.NumberFormat("en-US",{style:"currency",currency:e,minimumFractionDigits:0}).format(n),O=()=>{s.post(route("admin.enrollments.store"),{onSuccess:()=>{},onError:n=>{console.error("Enrollment errors:",n)}})};return(n,e)=>(d(),r(y,null,[w(o(T),{title:"Enroll Student"}),w(Z,{title:"Enroll Student",subtitle:"Create a new enrollment for a student"},{default:V(()=>[t("div",B,[t("form",{onSubmit:$(O,["prevent"]),class:"space-y-8"},[t("div",z,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold text-slate-800 mb-4"},"Student Information",-1)),t("div",G,[t("button",{type:"button",onClick:e[0]||(e[0]=l=>E(!0)),class:p(["px-4 py-2 rounded-xl text-sm font-medium transition-all",m.value?"bg-indigo-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])}," New Student ",2),t("button",{type:"button",onClick:e[1]||(e[1]=l=>E(!1)),class:p(["px-4 py-2 rounded-xl text-sm font-medium transition-all",m.value?"bg-slate-100 text-slate-600 hover:bg-slate-200":"bg-indigo-500 text-white"])}," Existing Student ",2)]),m.value?b("",!0):(d(),r("div",I,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Search Student",-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),type:"text",placeholder:"Search by name or email...",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},null,512),[[x,f.value]]),C.value.length>0?(d(),r("div",K,[(d(!0),r(y,null,k(C.value,l=>(d(),r("button",{key:l.id,type:"button",onClick:u=>D(l),class:p(["w-full px-4 py-3 text-left hover:bg-indigo-50 transition-colors border-b border-slate-100 last:border-b-0",o(s).user_id===l.id?"bg-indigo-50":""])},[t("div",R,i(l.name),1),t("div",W,i(l.email),1)],10,Q))),128))])):b("",!0)])),t("div",Y,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Full Name *",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o(s).name=l),type:"text",required:"",readonly:!m.value&&o(s).user_id,class:p(["w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200",!m.value&&o(s).user_id?"bg-slate-200 cursor-not-allowed":""])},null,10,H),[[x,o(s).name]]),o(s).errors.name?(d(),r("div",J,i(o(s).errors.name),1)):b("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Email *",-1)),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o(s).email=l),type:"email",required:"",readonly:!m.value&&o(s).user_id,class:p(["w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200",!m.value&&o(s).user_id?"bg-slate-200 cursor-not-allowed":""])},null,10,X),[[x,o(s).email]]),o(s).errors.email?(d(),r("div",ee,i(o(s).errors.email),1)):b("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Phone *",-1)),c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).phone=l),type:"text",required:"",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},null,512),[[x,o(s).phone]]),o(s).errors.phone?(d(),r("div",te,i(o(s).errors.phone),1)):b("",!0)]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Country *",-1)),c(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).country=l),required:"",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},[...e[15]||(e[15]=[t("option",{value:"Malawi"},"Malawi",-1),t("option",{value:"South Africa"},"South Africa",-1),t("option",{value:"Zimbabwe"},"Zimbabwe",-1),t("option",{value:"Zambia"},"Zambia",-1),t("option",{value:"Other"},"Other",-1)])],512),[[S,o(s).country]])]),t("div",se,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Address *",-1)),c(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o(s).address=l),type:"text",required:"",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},null,512),[[x,o(s).address]]),o(s).errors.address?(d(),r("div",oe,i(o(s).errors.address),1)):b("",!0)])])]),t("div",le,[t("h2",ne,[e[19]||(e[19]=U(" Select Subjects ",-1)),t("span",ie,"("+i(o(s).selected_subjects.length)+" selected)",1)]),o(s).errors.selected_subjects?(d(),r("div",re,i(o(s).errors.selected_subjects),1)):b("",!0),t("div",de,[(d(!0),r(y,null,k(j.value,(l,u)=>(d(),r("div",{key:u},[t("div",ae,[t("h3",ue,i(u),1),t("button",{type:"button",onClick:a=>F(u),class:"text-xs text-indigo-600 hover:text-indigo-800 font-medium"},i(l.every(a=>g(a.id))?"Deselect All":"Select All"),9,me)]),t("div",ce,[(d(!0),r(y,null,k(l,a=>(d(),r("button",{key:a.id,type:"button",onClick:Ae=>N(a.id),class:p(["p-3 rounded-xl text-left transition-all duration-200 border-2",g(a.id)?"border-indigo-500 bg-indigo-50 text-indigo-800":"border-slate-200 bg-slate-50 text-slate-700 hover:border-indigo-300"])},[t("div",pe,i(a.name),1),a.code?(d(),r("div",xe,i(a.code),1)):b("",!0)],10,be))),128))])]))),128))])]),t("div",fe,[e[29]||(e[29]=t("h2",{class:"text-lg font-semibold text-slate-800 mb-4"},"Enrollment Details",-1)),t("div",ge,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Enrollment Type *",-1)),c(t("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>o(s).enrollment_type=l),required:"",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},[...e[20]||(e[20]=[t("option",{value:"paid"},"Paid Enrollment",-1),t("option",{value:"free"},"Free (Admin Grant)",-1),t("option",{value:"trial"},"7-Day Trial",-1)])],512),[[S,o(s).enrollment_type]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Access Duration (Months) *",-1)),c(t("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>o(s).access_duration_months=l),required:"",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},[...e[22]||(e[22]=[t("option",{value:1},"1 Month",-1),t("option",{value:2},"2 Months",-1),t("option",{value:3},"3 Months",-1),t("option",{value:4},"4 Months",-1),t("option",{value:6},"6 Months",-1),t("option",{value:12},"12 Months (1 Year)",-1)])],512),[[S,o(s).access_duration_months]])]),t("div",ve,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Admin Notes",-1)),c(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>o(s).admin_notes=l),rows:"3",placeholder:"Optional notes about this enrollment...",class:"w-full bg-slate-100/70 backdrop-blur-sm px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200"},null,512),[[x,o(s).admin_notes]])])]),t("div",ye,[e[28]||(e[28]=t("h3",{class:"text-sm font-medium text-slate-700 mb-3"},"Pricing Summary",-1)),t("div",_e,[t("div",he,[e[25]||(e[25]=t("span",{class:"text-slate-600"},"Subjects Selected:",-1)),t("span",we,i(o(s).selected_subjects.length),1)]),t("div",ke,[e[26]||(e[26]=t("span",{class:"text-slate-600"},"Price per Subject:",-1)),t("span",Se,i(M(v.value.pricePerSubject,v.value.currency)),1)]),t("div",je,[e[27]||(e[27]=t("span",{class:"text-slate-800 font-medium"},"Total Amount:",-1)),t("span",Ce,i(M(v.value.total,v.value.currency)),1)])])])]),t("div",Ee,[w(o(L),{href:n.route("admin.enrollments.index"),class:"px-6 py-3 text-sm font-medium text-slate-600 bg-slate-100 rounded-2xl hover:bg-slate-200 transition-colors"},{default:V(()=>[...e[30]||(e[30]=[U(" Cancel ",-1)])]),_:1},8,["href"]),t("button",{type:"submit",disabled:o(s).processing||o(s).selected_subjects.length===0,class:"px-8 py-3 text-sm font-medium text-white bg-indigo-500 rounded-2xl hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},i(o(s).processing?"Enrolling...":"Enroll Student"),9,Me)])],32)])]),_:1})],64))}};export{qe as default};
