import{r as b,p as B,x as P,c as l,o as i,a as V,u as d,h as N,w as L,b as e,j as u,t as n,F as w,f as U,i as T,n as v,q as $,d as S,v as A}from"./app-eyie9m1X.js";import{_ as W}from"./DashboardLayout-abZ_OM8M.js";const F={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},z={class:"bg-amber-50 border border-amber-200 rounded-2xl p-6"},O={class:"flex items-center justify-between"},K={class:"text-2xl font-bold text-amber-800"},q={class:"bg-green-50 border border-green-200 rounded-2xl p-6"},E={class:"flex items-center justify-between"},G={class:"text-2xl font-bold text-green-800"},I={class:"bg-red-50 border border-red-200 rounded-2xl p-6"},Z={class:"flex items-center justify-between"},H={class:"text-2xl font-bold text-red-800"},J={class:"bg-indigo-50 border border-indigo-200 rounded-2xl p-6"},Q={class:"flex items-center justify-between"},X={class:"text-2xl font-bold text-indigo-800"},Y={class:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-slate-200/50 overflow-hidden mb-8"},ee={class:"p-6 border-b border-slate-200/50"},te={class:"text-sm text-slate-500 mt-1"},se={key:0,class:"divide-y divide-slate-200/50"},oe={class:"flex items-center justify-between"},ne={class:"flex items-center space-x-4"},re={class:"w-12 h-12 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg"},le={class:"font-semibold text-slate-800"},ie={key:0,class:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full"},ae={class:"flex items-center space-x-4 text-sm text-slate-600"},de={key:0,class:"text-xs text-slate-500 mt-1"},ue={class:"flex items-center space-x-3"},ce=["onClick"],me=["onClick"],xe={key:1,class:"p-12 text-center"},fe={class:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-slate-200/50 overflow-hidden"},pe={key:0,class:"divide-y divide-slate-200/50"},be={class:"flex items-center justify-between"},ve={class:"flex items-center space-x-4"},ge={class:"w-10 h-10 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold"},he={class:"font-semibold text-slate-800"},_e={class:"flex items-center space-x-4 text-sm text-slate-600"},ye={key:0},we={class:"flex items-center space-x-3"},ke={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},je={class:"bg-white/90 backdrop-blur-xl rounded-3xl p-4 sm:p-8 shadow-2xl border border-slate-200/50 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Me={class:"flex items-center justify-between mb-6"},Ce={class:"text-sm text-slate-600"},Pe={class:"bg-slate-50 rounded-2xl p-6 mb-6"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Ue={class:"font-medium text-slate-800 ml-2"},Se={class:"font-medium text-slate-800 ml-2"},Ae={class:"font-medium text-slate-800 ml-2"},De={class:"font-medium text-slate-800 ml-2"},Re={class:"font-medium text-slate-800 ml-2"},Be={key:0,class:"col-span-2"},Ne={class:"font-medium text-slate-800 ml-2"},Le={key:1,class:"col-span-2"},Te={class:"mb-6"},$e={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},We={key:0,class:"mb-6"},Fe={key:0,class:"mt-1 text-sm text-red-600"},ze={class:"mb-6"},Oe={class:"flex justify-end space-x-4"},Ke=["disabled"],qe={key:0},Ee={key:1},Ge={class:"max-w-4xl max-h-[90vh] p-4"},Ie=["src"],Ze={class:"text-center mt-4"},Qe={__name:"Index",props:{auth:Object,payments:Object,stats:Object},setup(c){const g=c;g.auth?.user;const h=b(!1),a=b(null),m=b(!1),k=b(null),o=B({status:"",action:"",admin_notes:"",notes:"",rejection_reason:""}),x=(r,t="MWK")=>(t==="MWK"?"MWK ":t==="ZAR"?"ZAR ":t==="USD"?"USD ":t+" ")+new Intl.NumberFormat().format(r),_=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=r=>{a.value=r,o.reset(),o.status="",h.value=!0},y=()=>{h.value=!1,a.value=null,o.reset()},j=r=>{k.value=r,m.value=!0},R=()=>{const r=o.status==="approved"?"approve":"reject";o.action=r,o.notes=o.admin_notes,r==="reject"?o.rejection_reason=o.rejection_reason||"":delete o.rejection_reason,o.post(route("payments.verify",a.value?.id),{onSuccess:()=>{y()},onError:t=>{console.error("Verification errors:",t)}})},f=P(()=>g.payments?.data?.filter(r=>r.status==="pending")||[]),M=P(()=>g.payments?.data?.filter(r=>r.status!=="pending").slice(0,5)||[]),C=r=>typeof r=="object"&&r!==null?r.name||r.code||"Unknown Method":{tnm_mpamba:"TNM Mpamba",airtel_money:"Airtel Money",bank_transfer:"Bank Transfer",mukuru:"Mukuru",worldremit:"WorldRemit",western_union:"Western Union",moneygram:"MoneyGram",paypal:"PayPal",wise:"Wise (TransferWise)",remitly:"Remitly"}[r]||(typeof r=="string"?r.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()):"Unknown Method");return(r,t)=>(i(),l(w,null,[V(d(N),{title:"Payment Verification"}),V(W,{title:"Payment Verification",subtitle:"Verify student payments manually"},{default:L(()=>[e("div",F,[e("div",z,[e("div",O,[e("div",null,[t[7]||(t[7]=e("p",{class:"text-amber-600 text-sm font-medium"},"Pending Verification",-1)),e("p",K,n(f.value.length),1)]),t[8]||(t[8]=e("div",{class:"w-10 h-10 bg-amber-200 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),e("div",q,[e("div",E,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-green-600 text-sm font-medium"},"Approved Today",-1)),e("p",G,n(c.payments?.data?.filter(s=>s.status==="approved"&&new Date(s.verified_at).toDateString()===new Date().toDateString()).length||0),1)]),t[10]||(t[10]=e("div",{class:"w-10 h-10 bg-green-200 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1))])]),e("div",I,[e("div",Z,[e("div",null,[t[11]||(t[11]=e("p",{class:"text-red-600 text-sm font-medium"},"Rejected",-1)),e("p",H,n(c.payments?.data?.filter(s=>s.status==="rejected")?.length||0),1)]),t[12]||(t[12]=e("div",{class:"w-10 h-10 bg-red-200 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),e("div",J,[e("div",Q,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-indigo-600 text-sm font-medium"},"Total Revenue",-1)),e("p",X,n(x((c.payments?.data?.filter(s=>s.status==="approved")||[]).reduce((s,p)=>s+parseFloat(p.calculated_amount||p.amount),0))),1)]),t[14]||(t[14]=e("div",{class:"w-10 h-10 bg-indigo-200 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1))])])]),e("div",Y,[e("div",ee,[t[15]||(t[15]=e("h2",{class:"text-xl font-bold text-slate-800"},"Pending Payment Verification",-1)),e("p",te,n(f.value.length)+" payments waiting for verification",1)]),f.value.length>0?(i(),l("div",se,[(i(!0),l(w,null,U(f.value,s=>(i(),l("div",{key:s.id,class:"p-6 hover:bg-slate-50/50 transition-colors duration-200"},[e("div",oe,[e("div",ne,[e("div",re,n(s.enrollment?.user?.name?.charAt(0)?.toUpperCase()||"U"),1),e("div",null,[e("h3",le,[T(n(s.enrollment?.user?.name||"Unknown User")+" ",1),s.payment_type==="subject_increase"?(i(),l("span",ie,"Subject Addition")):u("",!0)]),e("div",ae,[e("span",null,n(s.payment_method_name||C(s.payment_method_code||s.payment_method)),1),e("span",null,n(x(s.calculated_amount||s.amount,s.currency)),1),e("span",null,n(s.access_duration_days)+" days access",1),e("span",null,n(_(s.created_at)),1)]),s.reference_number?(i(),l("div",de," Ref: "+n(s.reference_number),1)):u("",!0)])]),e("div",ue,[s.payment_proof_path?(i(),l("button",{key:0,onClick:p=>j(r.route("payments.proof",s.id)),class:"px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm font-medium transition-colors duration-200"}," View Screenshot ",8,ce)):u("",!0),e("button",{onClick:p=>D(s),class:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg font-medium hover:from-indigo-600 hover:to-purple-700 transition-all duration-200 shadow-md"}," Verify Payment ",8,me)])])]))),128))])):(i(),l("div",xe,[...t[16]||(t[16]=[e("div",{class:"w-16 h-16 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1),e("h3",{class:"text-lg font-semibold text-slate-800 mb-2"},"All caught up!",-1),e("p",{class:"text-slate-500"},"No payments waiting for verification.",-1)])]))]),e("div",fe,[t[17]||(t[17]=e("div",{class:"p-6 border-b border-slate-200/50"},[e("h2",{class:"text-xl font-bold text-slate-800"},"Recently Verified"),e("p",{class:"text-sm text-slate-500 mt-1"},"Latest verification activities")],-1)),M.value.length>0?(i(),l("div",pe,[(i(!0),l(w,null,U(M.value,s=>(i(),l("div",{key:s.id,class:"p-6"},[e("div",be,[e("div",ve,[e("div",ge,n(s.enrollment?.user?.name?.charAt(0)?.toUpperCase()||"U"),1),e("div",null,[e("h3",he,n(s.enrollment?.user?.name||"Unknown User"),1),e("div",_e,[e("span",null,n(x(s.calculated_amount||s.amount,s.currency)),1),e("span",null,n(_(s.verified_at)),1),s.verified_by_user?(i(),l("span",ye,"by "+n(s.verified_by_user?.name||"Unknown"),1)):u("",!0)])])]),e("div",we,[e("div",{class:v(["px-3 py-1 rounded-full text-xs font-semibold",s.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},n(s.status.charAt(0).toUpperCase()+s.status.slice(1)),3)])])]))),128))])):u("",!0)]),h.value?(i(),l("div",ke,[e("div",je,[e("div",Me,[e("div",null,[t[18]||(t[18]=e("h3",{class:"text-xl font-bold text-slate-800"},"Verify Payment",-1)),e("p",Ce,n(a.value?.enrollment?.user?.name||"Unknown User"),1)]),e("button",{onClick:y,class:"p-2 hover:bg-slate-100 rounded-xl transition-colors duration-200"},[...t[19]||(t[19]=[e("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Pe,[e("div",Ve,[e("div",null,[t[20]||(t[20]=e("span",{class:"text-slate-500"},"Payment Method:",-1)),e("span",Ue,n(a.value?.payment_method_name||C(a.value?.payment_method_code||a.value?.payment_method)),1)]),e("div",null,[t[21]||(t[21]=e("span",{class:"text-slate-500"},"Amount:",-1)),e("span",Se,n(x(a.value?.calculated_amount||a.value?.amount,a.value?.currency)),1)]),e("div",null,[t[22]||(t[22]=e("span",{class:"text-slate-500"},"Access Duration:",-1)),e("span",Ae,n(a.value?.access_duration_days)+" days",1)]),e("div",null,[t[23]||(t[23]=e("span",{class:"text-slate-500"},"Payment Type:",-1)),e("span",De,n(a.value?.payment_type==="subject_increase"?"Subject Addition":"Regular Payment"),1)]),e("div",null,[t[24]||(t[24]=e("span",{class:"text-slate-500"},"Submitted:",-1)),e("span",Re,n(_(a.value?.created_at)),1)]),a.value?.reference_number?(i(),l("div",Be,[t[25]||(t[25]=e("span",{class:"text-slate-500"},"Reference Number:",-1)),e("span",Ne,n(a.value?.reference_number),1)])):u("",!0),a.value?.payment_proof_path?(i(),l("div",Le,[t[26]||(t[26]=e("span",{class:"text-slate-500"},"Payment Proof:",-1)),e("button",{onClick:t[0]||(t[0]=s=>j(r.route("payments.proof",a.value.id))),class:"ml-2 px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm font-medium transition-colors duration-200"}," View Screenshot ")])):u("",!0)])]),e("form",{onSubmit:$(R,["prevent"])},[e("div",Te,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-slate-700 mb-4"},"Verification Decision",-1)),e("div",$e,[e("button",{type:"button",onClick:t[1]||(t[1]=s=>d(o).status="approved"),class:v(["p-4 rounded-2xl border-2 transition-all duration-200 text-left",d(o).status==="approved"?"border-green-500 bg-green-50":"border-slate-200 hover:border-green-300"])},[...t[27]||(t[27]=[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])]),e("div",null,[e("h4",{class:"font-semibold text-green-800"},"Approve Payment"),e("p",{class:"text-sm text-green-600"},"Grant system access")])],-1)])],2),e("button",{type:"button",onClick:t[2]||(t[2]=s=>d(o).status="rejected"),class:v(["p-4 rounded-2xl border-2 transition-all duration-200 text-left",d(o).status==="rejected"?"border-red-500 bg-red-50":"border-slate-200 hover:border-red-300"])},[...t[28]||(t[28]=[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])]),e("div",null,[e("h4",{class:"font-semibold text-red-800"},"Reject Payment"),e("p",{class:"text-sm text-red-600"},"Deny system access")])],-1)])],2)])]),d(o).status==="rejected"?(i(),l("div",We,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Rejection Reason*",-1)),S(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>d(o).rejection_reason=s),rows:"3",required:"",class:"w-full bg-slate-100/70 px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-red-400 focus:bg-white transition-all duration-200",placeholder:"Please provide a reason for rejecting this payment..."},null,512),[[A,d(o).rejection_reason]]),d(o).errors.rejection_reason?(i(),l("div",Fe,n(d(o).errors.rejection_reason),1)):u("",!0)])):u("",!0),e("div",ze,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Admin Notes (Optional)",-1)),S(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>d(o).admin_notes=s),rows:"3",class:"w-full bg-slate-100/70 px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:bg-white transition-all duration-200",placeholder:"Additional notes about this verification..."},null,512),[[A,d(o).admin_notes]])]),e("div",Oe,[e("button",{type:"button",onClick:y,class:"px-6 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-2xl font-semibold transition-all duration-200"}," Cancel "),e("button",{type:"submit",disabled:d(o).processing||!d(o).status,class:v(["px-6 py-3 rounded-2xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",d(o).status==="approved"?"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700":"bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700"])},[d(o).processing?(i(),l("span",qe,"Processing...")):(i(),l("span",Ee,n(d(o).status==="approved"?"Approve Payment":"Reject Payment"),1))],10,Ke)])],32)])])):u("",!0),m.value?(i(),l("div",{key:1,class:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[6]||(t[6]=s=>m.value=!1)},[e("div",Ge,[e("img",{src:k.value,alt:"Payment proof",class:"max-w-full max-h-full rounded-2xl shadow-2xl"},null,8,Ie),e("div",Ze,[e("button",{onClick:t[5]||(t[5]=s=>m.value=!1),class:"px-4 py-2 bg-white/90 hover:bg-white text-slate-800 rounded-lg font-medium transition-colors duration-200"}," Close ")])])])):u("",!0)]),_:1})],64))}};export{Qe as default};
