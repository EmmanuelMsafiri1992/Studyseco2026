import{r as p,p as Q,x as f,z as E,c as o,o as l,a as F,u as j,h as G,w as H,b as t,j as u,t as a,d as R,v as J,F as b,f as y,g as U,n as v,q as T,i as K,m as W}from"./app-CRjWoFff.js";import{_ as X}from"./DashboardLayout-1zt2QAKD.js";const Z={class:"max-w-6xl mx-auto"},ee={class:"bg-white rounded-xl shadow-sm p-6 mb-8"},te={key:0,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800"},se={key:1,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800"},oe={key:2,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-amber-100 text-amber-800"},le={class:"grid lg:grid-cols-3 gap-8"},ae={class:"lg:col-span-2"},re={class:"bg-white rounded-xl shadow-sm"},ie={class:"p-6 border-b border-gray-200"},ne={class:"space-y-4"},de={class:"flex items-center gap-4"},ce={class:"flex-1"},ue=["value"],ve={class:"flex items-center justify-between"},ge={class:"flex items-center gap-4"},xe=["value"],me={class:"flex items-center gap-2"},be={class:"text-sm text-gray-500"},he={class:"p-6"},pe={key:0,class:"text-center py-12"},ye={key:1,class:"grid gap-4"},_e=["onClick"],fe={class:"flex items-start justify-between"},we={class:"flex-1"},ke={class:"flex items-center gap-2 mb-2"},Se={class:"font-semibold text-gray-900"},Ce={class:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded"},$e={class:"text-sm text-gray-600 mb-2"},Pe={class:"flex items-center gap-4 text-xs text-gray-500"},je={class:"ml-4 flex flex-col items-end gap-2"},Me={key:0,class:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},Ne=["onClick"],Ae={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},De=["onClick"],Re={class:"flex items-center justify-between"},Ve={class:"flex-1 min-w-0"},Le={class:"flex items-center gap-2"},qe={class:"font-medium text-gray-900 text-sm truncate"},Be={key:0,class:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium"},Ee={class:"text-xs text-gray-600 truncate"},Fe={class:"flex items-center gap-3 mt-1"},Ue={class:"text-xs text-gray-500"},Te=["onClick"],Ye={key:3,class:"mt-6 flex items-center justify-between"},ze={class:"text-sm text-gray-500"},Ie={class:"flex items-center gap-2"},Oe=["disabled"],Qe={class:"flex gap-1"},Ge=["onClick"],He=["disabled"],Je={class:"lg:col-span-1"},Ke={class:"bg-white rounded-xl shadow-sm sticky top-8"},We={class:"p-6"},Xe={key:0,class:"text-center py-8"},Ze={key:1,class:"space-y-3"},et={class:"flex items-center justify-between"},tt={class:"flex items-center gap-2 mb-1"},st={class:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded font-medium"},ot={class:"font-medium text-gray-900 text-sm"},lt={class:"text-xs text-gray-500"},at={class:"flex items-center gap-1"},rt=["onClick"],it=["onClick"],nt=["onClick"],dt={class:"mt-6 pt-4 border-t border-gray-200"},ct=["disabled"],ut={key:0},vt={key:1},gt={key:2},xt={key:0,class:"mt-8"},mt={class:"bg-white rounded-xl shadow-sm"},bt={class:"p-6"},ht={class:"grid gap-4"},pt={class:"flex items-center justify-between"},yt={class:"flex items-center gap-2 mb-2"},_t={class:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded"},ft={class:"font-medium text-gray-900"},wt={class:"text-sm text-gray-600"},kt={class:"flex items-center gap-2"},St={key:0,class:"mt-2 p-2 bg-red-50 rounded text-sm text-red-700"},Pt={__name:"Index",props:{schools:Array,userSelections:Array,hasRequiredSelections:Boolean,confirmedSchool:Object},setup(g){const C=g,h=p(""),x=p(""),_=p(""),i=p([]),w=p("compact"),d=p(1),M=p(4),k=Q({school_selections:[]}),Y=f(()=>[...new Set((C.schools||[]).map(r=>r.region))].sort()),z=f(()=>{const r=x.value?(C.schools||[]).filter(s=>s.region===x.value):C.schools||[];return[...new Set(r.map(s=>s.district))].sort()}),$=f(()=>(C.schools||[]).filter(s=>{const e=!h.value||s.name.toLowerCase().includes(h.value.toLowerCase())||s.region.toLowerCase().includes(h.value.toLowerCase())||s.district.toLowerCase().includes(h.value.toLowerCase()),n=!x.value||s.region===x.value,c=!_.value||s.district===_.value;return e&&n&&c}).sort((s,e)=>(e.available_slots||0)-(s.available_slots||0))),S=f(()=>Math.ceil($.value.length/M.value)),N=f(()=>{const r=(d.value-1)*M.value,s=r+M.value;return $.value.slice(r,s)}),I=f(()=>{const r=S.value,s=d.value,e=2;let n=Math.max(1,s-e),c=Math.min(r,s+e);c-n<e*2&&(n=Math.max(1,c-e*2),c=Math.min(r,n+e*2));const P=[];for(let D=n;D<=c;D++)P.push(D);return P}),m=r=>i.value.some(s=>s.school.id===r),V=r=>{const s=i.value.findIndex(e=>e.school.id===r);return s>=0?s+1:null},A=r=>{if(i.value.length>=5){alert("You can select maximum 5 schools.");return}m(r.id)||i.value.push({school:r,priority:i.value.length+1})},L=r=>{i.value=i.value.filter(s=>s.school.id!==r),i.value.forEach((s,e)=>{s.priority=e+1})},q=(r,s)=>{const e=r+s;if(e>=0&&e<i.value.length){const n=i.value[r];i.value[r]=i.value[e],i.value[e]=n,i.value.forEach((c,P)=>{c.priority=P+1})}},O=()=>{if(i.value.length<5){alert("Please select at least 5 schools.");return}k.school_selections=i.value.map((r,s)=>({school_id:r.school.id,priority:s+1})),k.post(route("school-selections.store"),{onSuccess:()=>{i.value=[],W.reload()}})},B=r=>{r.available_slots!==0&&(m(r.id)?L(r.id):A(r))};return E([h,x,_],()=>{d.value=1}),E(x,()=>{_.value=""}),(r,s)=>(l(),o(b,null,[F(j(G),{title:"School Selection"}),F(X,{title:"School Selection",subtitle:"Choose schools for your exam centers"},{default:H(()=>[t("div",Z,[t("div",ee,[s[7]||(s[7]=t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Select Schools for Exam Centers",-1)),s[8]||(s[8]=t("p",{class:"text-gray-600 mb-4"},"Choose at least 5 secondary schools where you would like to sit for your exams. Schools will review and confirm your application.",-1)),g.confirmedSchool?(l(),o("div",te," âœ… Confirmed at "+a(g.confirmedSchool.secondarySchool?.name||"Selected School"),1)):g.hasRequiredSelections?(l(),o("div",se," â³ "+a(g.userSelections?.length||0)+" schools selected - awaiting confirmation ",1)):(l(),o("div",oe," ðŸ“ Need "+a(5-(g.userSelections?.length||0))+" more school selections ",1))]),t("div",le,[t("div",ae,[t("div",re,[t("div",ie,[s[12]||(s[12]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Available Schools",-1)),t("div",ne,[t("div",de,[t("div",ce,[R(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e),type:"text",placeholder:"Search schools by name, region, or district...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[J,h.value]])]),R(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>x.value=e),class:"px-4 py-2 border border-gray-300 rounded-lg"},[s[9]||(s[9]=t("option",{value:""},"All Regions",-1)),(l(!0),o(b,null,y(Y.value,e=>(l(),o("option",{key:e,value:e},a(e),9,ue))),128))],512),[[U,x.value]])]),t("div",ve,[t("div",ge,[R(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>_.value=e),class:"px-3 py-2 border border-gray-300 rounded-lg text-sm"},[s[10]||(s[10]=t("option",{value:""},"All Districts",-1)),(l(!0),o(b,null,y(z.value,e=>(l(),o("option",{key:e,value:e},a(e),9,xe))),128))],512),[[U,_.value]]),t("div",me,[s[11]||(s[11]=t("label",{class:"text-sm text-gray-600"},"View:",-1)),t("button",{onClick:s[3]||(s[3]=e=>w.value="detailed"),class:v([w.value==="detailed"?"bg-blue-600 text-white":"bg-gray-200 text-gray-600","px-3 py-1 rounded text-sm"])}," Detailed ",2),t("button",{onClick:s[4]||(s[4]=e=>w.value="compact"),class:v([w.value==="compact"?"bg-blue-600 text-white":"bg-gray-200 text-gray-600","px-3 py-1 rounded text-sm"])}," Compact ",2)])]),t("div",be," Showing "+a(N.value.length)+" of "+a($.value.length)+" schools ",1)])])]),t("div",he,[$.value.length===0?(l(),o("div",pe,[...s[13]||(s[13]=[t("div",{class:"text-gray-400 text-6xl mb-4"},"ðŸ«",-1),t("p",{class:"text-gray-500"},"No schools match your search criteria.",-1)])])):w.value==="detailed"?(l(),o("div",ye,[(l(!0),o(b,null,y(N.value,e=>(l(),o("div",{key:e.id,class:v(["border-2 rounded-lg p-4 cursor-pointer transition-all",m(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300",e.available_slots===0?"opacity-50 cursor-not-allowed":""]),onClick:n=>B(e)},[t("div",fe,[t("div",we,[t("div",ke,[t("h3",Se,a(e.name),1),t("span",Ce,a(e.code),1)]),t("p",$e,a(e.formatted_address),1),t("div",Pe,[t("span",null,"ðŸ“ž "+a(e.phone||"N/A"),1),t("span",null,"ðŸ‘¥ "+a(e.capacity)+" capacity",1),t("span",{class:v(e.available_slots>0?"text-green-600":"text-red-600")},a(e.available_slots)+" slots available ",3)])]),t("div",je,[m(e.id)?(l(),o("div",Me," Priority #"+a(V(e.id)),1)):u("",!0),!m(e.id)&&i.value.length<5&&e.available_slots>0?(l(),o("button",{key:1,onClick:T(n=>A(e),["stop"]),class:"bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700"}," Select ",8,Ne)):u("",!0)])])],10,_e))),128))])):(l(),o("div",Ae,[(l(!0),o(b,null,y(N.value,e=>(l(),o("div",{key:e.id,class:v(["border-2 rounded-lg p-3 cursor-pointer transition-all",m(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300",e.available_slots===0?"opacity-50 cursor-not-allowed":""]),onClick:n=>B(e)},[t("div",Re,[t("div",Ve,[t("div",Le,[t("h3",qe,a(e.name),1),m(e.id)?(l(),o("div",Be," #"+a(V(e.id)),1)):u("",!0)]),t("p",Ee,a(e.district)+", "+a(e.region),1),t("div",Fe,[t("span",Ue,a(e.capacity)+" cap.",1),t("span",{class:v([e.available_slots>0?"text-green-600":"text-red-600","text-xs"])},a(e.available_slots)+" slots ",3)])]),!m(e.id)&&i.value.length<5&&e.available_slots>0?(l(),o("button",{key:0,onClick:T(n=>A(e),["stop"]),class:"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700 ml-2"}," Select ",8,Te)):u("",!0)])],10,De))),128))])),S.value>1?(l(),o("div",Ye,[t("div",ze," Page "+a(d.value)+" of "+a(S.value),1),t("div",Ie,[t("button",{onClick:s[5]||(s[5]=e=>d.value=Math.max(1,d.value-1)),disabled:d.value===1,class:"px-3 py-2 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Previous ",8,Oe),t("div",Qe,[(l(!0),o(b,null,y(I.value,e=>(l(),o("button",{key:e,onClick:n=>d.value=e,class:v(["px-3 py-2 text-sm border rounded-lg",e===d.value?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"])},a(e),11,Ge))),128))]),t("button",{onClick:s[6]||(s[6]=e=>d.value=Math.min(S.value,d.value+1)),disabled:d.value===S.value,class:"px-3 py-2 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Next ",8,He)])])):u("",!0)])])]),t("div",Je,[t("div",Ke,[s[15]||(s[15]=t("div",{class:"p-6 border-b border-gray-200"},[t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Your School Selections"),t("p",{class:"text-sm text-gray-600"},"Drag to reorder by preference")],-1)),t("div",We,[i.value.length===0?(l(),o("div",Xe,[...s[14]||(s[14]=[t("div",{class:"text-gray-400 text-4xl mb-4"},"ðŸ“‹",-1),t("p",{class:"text-gray-500 text-sm"},"No schools selected yet.",-1),t("p",{class:"text-gray-400 text-xs mt-1"},"Select at least 5 schools from the left.",-1)])])):(l(),o("div",Ze,[(l(!0),o(b,null,y(i.value,(e,n)=>(l(),o("div",{key:e.school.id,class:"border border-gray-200 rounded-lg p-3"},[t("div",et,[t("div",null,[t("div",tt,[t("span",st," #"+a(n+1),1),t("h4",ot,a(e.school.name),1)]),t("p",lt,a(e.school.district)+", "+a(e.school.region),1)]),t("div",at,[n>0?(l(),o("button",{key:0,onClick:c=>q(n,-1),class:"text-gray-400 hover:text-gray-600 p-1"}," â†‘ ",8,rt)):u("",!0),n<i.value.length-1?(l(),o("button",{key:1,onClick:c=>q(n,1),class:"text-gray-400 hover:text-gray-600 p-1"}," â†“ ",8,it)):u("",!0),t("button",{onClick:c=>L(e.school.id),class:"text-red-400 hover:text-red-600 p-1"}," âœ• ",8,nt)])])]))),128))])),t("div",dt,[t("button",{onClick:O,disabled:i.value.length<5||j(k).processing,class:v(["w-full py-3 px-4 rounded-lg font-medium",i.value.length>=5&&!j(k).processing?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-400 cursor-not-allowed"])},[j(k).processing?(l(),o("span",ut,"Saving...")):i.value.length<5?(l(),o("span",vt," Need "+a(5-i.value.length)+" more schools ",1)):(l(),o("span",gt,"Save School Selections ("+a(i.value.length)+")",1))],10,ct)])])])])]),(g.userSelections?.length||0)>0?(l(),o("div",xt,[t("div",mt,[s[17]||(s[17]=t("div",{class:"p-6 border-b border-gray-200"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"Your Current Applications")],-1)),t("div",bt,[t("div",ht,[(l(!0),o(b,null,y(g.userSelections||[],e=>(l(),o("div",{key:e.id,class:"border border-gray-200 rounded-lg p-4"},[t("div",pt,[t("div",null,[t("div",yt,[t("span",_t," Priority #"+a(e.priority_order),1),t("h3",ft,a(e.secondary_school.name),1)]),t("p",wt,a(e.secondary_school.formatted_address),1)]),t("div",kt,[t("span",{class:v(["px-2 py-1 rounded text-xs font-medium",e.status==="confirmed"?"bg-green-100 text-green-800":e.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},a(e.status.charAt(0).toUpperCase()+e.status.slice(1)),3)])]),e.rejection_reason?(l(),o("div",St,[s[16]||(s[16]=t("strong",null,"Reason:",-1)),K(" "+a(e.rejection_reason),1)])):u("",!0)]))),128))])])])])):u("",!0)])]),_:1})],64))}};export{Pt as default};
